(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53656b10"],{7423:function(t,e,a){"use strict";var s=a("d658"),n=a.n(s);n.a},d658:function(t,e,a){},d8b6:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"Home"},[a("van-nav-bar",{attrs:{title:"事件详情","left-text":"返回","left-arrow":"",fixed:!0},on:{"click-left":t.onClickLeft}}),a("div",{staticClass:"con"},[a("van-cell-group",[a("van-cell",{attrs:{title:"事件编号：",value:t.dateils.eventCode}}),1!=t.dateils.event_status_now?a("van-cell",{attrs:{title:"开始执行时间",value:t._f("teShuTime")(t.dateils.startTime)}}):t._e(),1!=t.dateils.event_status_now&&7!=t.dateils.event_status_now&&5!=t.dateils.event_status_now&&4!=t.dateils.event_status_now&&17!=t.dateils.event_status_now?a("van-cell",{attrs:{title:"规定工时",value:t.dateils.duration+"(小时）"}}):t._e(),1!=t.dateils.event_status_now&&7!=t.dateils.event_status_now&&5!=t.dateils.event_status_now&&4!=t.dateils.event_status_now&&17!=t.dateils.event_status_now&&6!=t.dateils.event_status_now?a("van-cell",{attrs:{title:"当前工时",value:t._f("guoQuTime1")(t.numTime,t.nowTime)}}):t._e(),6==t.dateils.event_status_now?a("van-cell",{attrs:{title:"完成总耗时",value:t._f("haoMiao")(t.dateils.totalConsumeHours)}}):t._e(),1!=t.dateils.event_status_now&&7!=t.dateils.event_status_now&&5!=t.dateils.event_status_now&&4!=t.dateils.event_status_now&&17!=t.dateils.event_status_now&&6!=t.dateils.event_status_now?a("van-cell",{attrs:{title:"距离结束还剩",value:t._f("guoQu")(t.dateils.duration,t.numTime,t.nowTime)}}):t._e(),8==t.dateils.event_status_now?a("van-cell",{attrs:{title:"申请延期时间",value:t.dateils.delayHours+"小时"}}):t._e()],1),a("p",{staticClass:"tlt"},[t._v("报事信息")]),a("van-cell-group",[a("van-cell",{attrs:{title:"报事人",value:t.dateils.reporter_name}}),a("van-cell",{attrs:{title:"报事类型",value:t.dateils.event_type_name}}),a("van-cell",{attrs:{title:"报事时间",value:t._f("teShuTime")(t.dateils.report_time)}}),null==t.dateils.floor_name&&null==t.dateils.location_name?a("van-cell",{attrs:{title:"位置信息",value:t.dateils.building_name}}):null==t.dateils.location_name?a("van-cell",{attrs:{title:"位置信息",value:t.dateils.building_name+"/"+t.dateils.floor_name}}):a("van-cell",{attrs:{title:"位置信息",value:t.dateils.building_name+"/"+t.dateils.floor_name+"/"+t.dateils.location_name}}),a("van-cell",{attrs:{title:"详细地址",value:t.message1}}),a("van-cell",{attrs:{title:"报事描述"}}),a("van-field",{attrs:{disabled:"",rows:"2",autosize:"",type:"textarea","show-word-limit":""},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),t._l(t.imgs,(function(e,s){return t.flag?a("van-image",{key:s,staticStyle:{margin:"0 5px"},attrs:{width:"3rem",height:"3rem",fit:"cover",src:e},on:{click:function(e){return t.getImg(s)}}}):t._e()}))],2),6==t.dateils.event_status_now?a("div",[a("p",{staticClass:"tlt"},[t._v("完成信息")]),a("van-cell-group",[t.dateils.tbEventCompleteBeans?a("van-cell",{attrs:{title:"完成人",value:t.comName1}}):t._e(),t.dateils.tbEventCompleteBeans?a("van-cell",{attrs:{title:"完工描述",value:t.dateils.tbEventCompleteBeans[0].description}}):t._e(),t._l(t.imgs1,(function(e,s){return t.flag1?a("van-image",{key:s,staticStyle:{margin:"0 5px"},attrs:{width:"3rem",height:"3rem",fit:"cover",src:e},on:{click:function(e){return t.getImg1(s)}}}):t._e()}))],2)],1):t._e(),a("div",{staticClass:"box flex_a"},[1==t.dateils.event_status_now||4==t.dateils.event_status_now||11==t.dateils.event_status_now||17==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44"},on:{click:t.allocation}},[t._v("分配事件")]):t._e(),1==t.dateils.event_status_now||4==t.dateils.event_status_now||11==t.dateils.event_status_now||17==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44"},on:{click:t.merge}},[t._v("合并事件")]):t._e(),1==t.dateils.event_status_now||4==t.dateils.event_status_now||11==t.dateils.event_status_now||17==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44",to:"/careOf"}},[t._v("转交事件")]):t._e(),1==t.dateils.event_status_now||4==t.dateils.event_status_now||11==t.dateils.event_status_now||17==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44",to:"/up"}},[t._v("上报事件")]):t._e(),1!=t.dateils.event_status_now&&4!=t.dateils.event_status_now&&5!=t.dateils.event_status_now&&7!=t.dateils.event_status_now&&8!=t.dateils.event_status_now&&11!=t.dateils.event_status_now&&6!=t.dateils.event_status_now&&17!=t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44"},on:{click:t.wanCheng}},[t._v("完成事件")]):t._e(),1!=t.dateils.event_status_now&&4!=t.dateils.event_status_now&&5!=t.dateils.event_status_now&&7!=t.dateils.event_status_now&&8!=t.dateils.event_status_now&&11!=t.dateils.event_status_now&&6!=t.dateils.event_status_now&&17!=t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44",to:"/out"}},[t._v("退回事件")]):t._e(),1!=t.dateils.event_status_now&&4!=t.dateils.event_status_now&&5!=t.dateils.event_status_now&&7!=t.dateils.event_status_now&&8!=t.dateils.event_status_now&&11!=t.dateils.event_status_now&&6!=t.dateils.event_status_now&&17!=t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44",to:"/postpone"}},[t._v("延期事件")]):t._e(),6==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"large",color:"#a68e44"},on:{click:t.yanShou}},[t._v("验收事件")]):t._e(),5==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44"},on:{click:function(e){return t.btn(1)}}},[t._v("同意")]):t._e(),5==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44"},on:{click:function(e){return t.btn(2)}}},[t._v("拒绝")]):t._e(),8==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44"},on:{click:function(e){return t.btn1(1)}}},[t._v("同意")]):t._e(),8==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44"},on:{click:function(e){return t.btn1(2)}}},[t._v("拒绝")]):t._e(),7==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44"},on:{click:function(e){return t.btn2(1)}}},[t._v("同意")]):t._e(),7==t.dateils.event_status_now?a("van-button",{attrs:{type:"primary",size:"mini",color:"#a68e44"},on:{click:function(e){return t.btn2(2)}}},[t._v("拒绝")]):t._e()],1),5==t.dateils.event_status_now||7==t.dateils.event_status_now||8==t.dateils.event_status_now?a("van-field",{attrs:{rows:"2",autosize:"",label:"留言",type:"textarea",maxlength:"50",placeholder:"请输入留言","show-word-limit":""},model:{value:t.miaoShu,callback:function(e){t.miaoShu=e},expression:"miaoShu"}}):t._e(),a("p",{staticClass:"tlt"},[t._v("进度")]),t._l(t.dateils.tbEventLogBeans,(function(e,s){return a("div",{key:s,staticClass:"plan"},[a("div",{staticClass:"flex_l"},[a("van-icon",{attrs:{name:"clock-o",color:"#A68E44",size:"20px"}}),a("p",[a("a",{attrs:{href:"tel:"+e.fromUserMobile}},[t._v(t._s(e.fromUserName))]),t._v("\n          "+t._s(e.processRemark)+"\n          "),a("a",{attrs:{href:"tel:"+e.toUserMobile}},[t._v(t._s(e.toUserName))]),t._v("\n          处理\n        ")])],1),a("p",[t._v("\n        "+t._s(t._f("teShuTime")(e.createTime))+"\n        "),null!==e.hours?a("i",[t._v("| 延时时长"+t._s(e.hours)+"(小时)")]):t._e()]),a("p",[null!=e.imgUrl&&""!=e.imgUrl?a("a",{key:s,staticStyle:{color:"#7ac4ff"},attrs:{href:t.url+e.imgUrl.split(",")[0]}},[t._v("查看图片")]):t._e()]),a("p",[t._v("描述："+t._s(e.remark))])])}))],2)],1)},n=[],i=(a("a481"),a("28a5"),a("28a2")),o={data:function(){return{message:"",message1:"",id:"",dateils:"",nowTime:new Date,miaoShu:"",imgs:[],imgs1:[],imgs3:[],flag:!0,flag1:!0,numTime:"",url:"",type_dept:"",comName:[],comName1:"",comNameId:[],comNameId1:""}},components:{},mounted:function(){var t=this;this.url=unescape(localStorage.getItem("baseUrl")),this.id=sessionStorage.getItem("id"),this.axios.get("/rest/tbEventReport/getEventInfoByEventId",{params:{uid:localStorage.getItem("uid"),event_id:this.id,eventStatusNow:sessionStorage.getItem("eventStatusNow")}}).then((function(e){t.dateils=e;for(var a=0;a<e.tbEventCompleteBeans.length;a++)t.comName.push(e.tbEventCompleteBeans[a].completeUserName),t.comNameId.push(e.tbEventCompleteBeans[a].completeUserId);t.comName1=t.comName.join(","),t.comNameId1=t.comNameId.join(","),t.type_dept=e.event_type_id,null!=e.tbEventAllocationBean&&(t.numTime=e.tbEventAllocationBean.startTime),""==e.imgurl&&(t.flag=!1,t.flag1=!1);var s=e.imgurl,n=s.split(","),i=unescape(localStorage.getItem("baseUrl")),o=i.replace("https","http");console.log(o);for(a=0;a<n.length;a++)t.imgs.push(o+n[a]);if(""!=e.tbEventCompleteBeans){""==e.tbEventCompleteBeans[0].imgUrl&&(t.flag1=!1);s=e.tbEventCompleteBeans[0].imgUrl;var l=s.split(","),r=(o=unescape(localStorage.getItem("baseUrl")),o.replace("https","http"));for(a=0;a<l.length;a++)t.imgs1.push(r+l[a])}""!==e.report_remark?t.message=e.report_remark:t.message="无事件描述",""!==e.location_description?t.message1=e.location_description:t.message1="无详细地址描述"}))},methods:{wanCheng:function(){null!=this.dateils.tbPatrolPointBean?this.$router.push({path:"/wanCheng",query:{num:"1"}}):this.$router.push("/wanCheng")},merge:function(){this.$router.push("/merge"),localStorage.setItem("eventCode",this.dateils.eventCode)},onClickLeft:function(){this.$router.push("/eventList")},allocation:function(){this.$router.push({name:"allocation",query:{type_dept:this.type_dept}})},btn:function(t){var e=this;this.axios.get("/rest/tbEventReport/checkInvalidEvent",{params:{uid:localStorage.getItem("uid"),event_id:sessionStorage.getItem("id"),status:t,description:this.miaoShu}}).then((function(a){1==t?e.$toast("同意无效任务"):e.$toast("拒绝无效任务"),e.$router.push("eventList")}))},btn1:function(t){var e=this;this.axios.get("/rest/tbEventReport/checkDelayEvent",{params:{uid:localStorage.getItem("uid"),event_id:sessionStorage.getItem("id"),status:t,description:this.miaoShu,hours:this.dateils.delayHours}}).then((function(a){1==t?e.$toast("同意延期"):e.$toast("拒绝延期"),e.$router.push("eventList")}))},btn2:function(t){var e=this;this.axios.get("/rest/tbEventReport/checkBackEvent",{params:{uid:localStorage.getItem("uid"),event_id:sessionStorage.getItem("id"),status:t,description:this.miaoShu}}).then((function(a){1==t?e.$toast("同意退回"):e.$toast("拒绝退回"),e.$router.push("eventList")}))},yanShou:function(){this.$router.push({path:"/check",query:{userName:this.comName1,userNameId:this.comNameId1}})},getImg:function(t){Object(i["a"])({images:this.imgs,showIndex:!0,loop:!0,startPosition:t})},getImg1:function(t){Object(i["a"])({images:this.imgs1,showIndex:!0,loop:!0,startPosition:t})}}},l=o,r=(a("7423"),a("2877")),u=Object(r["a"])(l,s,n,!1,null,"355f2da9",null);e["default"]=u.exports}}]);