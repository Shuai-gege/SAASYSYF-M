(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-96f23b44"],{8358:function(t,e,a){},"8de0":function(t,e,a){"use strict";var o=a("8358"),s=a.n(o);s.a},dc3f:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("div",{staticClass:"con"},[a("div",{staticClass:"ipt"},[a("van-field",{attrs:{label:"手机号",placeholder:"请输入手机号"},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}}),a("van-field",{attrs:{center:"",clearable:"",label:"短信验证码",placeholder:"请输入短信验证码"},scopedSlots:t._u([{key:"button",fn:function(){return[t.flag?a("van-count-down",{attrs:{time:t.time,format:"ss"},on:{finish:t.finish}}):a("van-button",{attrs:{size:"small",type:"primary",round:!0,color:"#a68e44",disabled:t.jinXuan},on:{click:t.phoneSms}},[t._v("发送验证码")])]},proxy:!0}]),model:{value:t.sms,callback:function(e){t.sms=e},expression:"sms"}})],1),a("div",{staticClass:"btn"},[a("van-button",{attrs:{type:"primary",size:"large",color:"#a68e44",disabled:t.jinXuan},on:{click:t.login}},[t._v("登陆")])],1),a("div",{staticClass:"res"},[a("a",{on:{click:function(e){return t.$router.push("/introduce")}}},[t._v("注册成为iguard物管平台用户>")])])])])},s=[],n=(a("a481"),a("bc3a")),i=a.n(n),r={data:function(){return{phone:"",sms:"",err:"",flag:!1,openid:"",jinXuan:!1,time:18e4}},mounted:function(){var t=this.getUrlValue("code");if(localStorage.setItem("code",t),!localStorage.getItem("appid")&&!localStorage.getItem("wxkey")||void 0==t)i.a.get("https://test.mallmis.com/v1/rest/wxserver/getWxConfig").then((function(e){if(localStorage.setItem("appid",e.data.result[0].wxValue),localStorage.setItem("wxkey",e.data.result[1].wxValue),localStorage.setItem("baseUrl",escape(e.data.result[2].wxValue)),null==t||void 0==t||t==localStorage.getItem("code")){var a=window.location.href;location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+localStorage.getItem("appid")+"&redirect_uri="+escape(a)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect"}}));else{localStorage.getItem("appid"),localStorage.getItem("wxkey");i()({mothod:"get",url:"https://test.mallmis.com/v1/rest/wxserver/getOpenid",params:{code:t}}).then((function(t){localStorage.setItem("openid",t.data.result)}))}},methods:{tel:function(){var t=this;""==this.phone?this.$toast("请输入手机号"):/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.phone)?this.axios.get("/rest/wxserver/checkUser",{params:{phone:this.phone}}).then((function(e){0==e&&(t.$toast("没有此用户"),t.jinXuan=!0)})):this.$toast("手机号码有误，请重填")},getUrlValue:function(t){var e=window.location.href,a=/([^?&=]+)=([^?&=]+)/g,o={};for(var s in e.replace(a,(function(){o[arguments[1]]=arguments[2]})),o)if(s==t)return o[s]},phoneSms:function(){var t=this;""==this.phone?this.$toast("请输入手机号"):/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.phone)?this.axios.get("/rest/wxserver/checkUser",{params:{phone:this.phone}}).then((function(e){0==e?(t.$toast("没有此用户"),t.jinXuan=!0):t.axios.get("/rest/wxserver/getSMCode",{params:{phone:t.phone}}).then((function(e){console.log(e),"验证码发送成功"==e?(t.$toast("发送成功"),t.flag=!0,t.time=18e4):(t.$toast(e),t.flag=!0)}))})):this.$toast("手机号码有误，请重填")},login:function(){var t=this;""==this.phone?this.$toast("请输入手机号"):""==this.sms?this.$toast("请输入验证码"):i.a.get("/rest/wxserver/loginByWX",{params:{phone:this.phone,openid:localStorage.getItem("openid"),smCode:this.sms}}).then((function(e){console.log(e),null!=e.data.result?(localStorage.setItem("uid",e.data.result.uid),localStorage.setItem("userName",e.data.result.vserName),localStorage.setItem("deptName",e.data.result.deptName),t.$router.push("/")):t.$toast("入职申请暂未通过！")}))},finish:function(){this.flag=!1}}},l=r,c=(a("8de0"),a("2877")),u=Object(c["a"])(l,o,s,!1,null,"eff6422a",null);e["default"]=u.exports}}]);