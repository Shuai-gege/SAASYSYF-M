(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44a9ceea"],{"2f21":function(t,e,o){"use strict";var n=o("79e5");t.exports=function(t,e){return!!t&&n((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"55dd":function(t,e,o){"use strict";var n=o("5ca1"),s=o("d8e8"),i=o("4bf8"),l=o("79e5"),a=[].sort,r=[1,2,3];n(n.P+n.F*(l((function(){r.sort(void 0)}))||!l((function(){r.sort(null)}))||!o("2f21")(a)),"Array",{sort:function(t){return void 0===t?a.call(i(this)):a.call(i(this),s(t))}})},"7ba5":function(t,e,o){"use strict";var n=o("c18d"),s=o.n(n);s.a},"8d6b":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"mescroll",staticClass:"mescroll"},[o("div",[t._t("default")],2)])},s=[],i=o("f868"),l=o.n(i),a=(o("f2fd"),{name:"MeScrollVue",data:function(){return{mescroll:null,lastScrollTop:0,lastBounce:null}},props:{up:Object,down:Object},mounted:function(){this.mescroll=new l.a(this.$refs.mescroll,{up:this.up,down:this.down}),this.$emit("init",this.mescroll)},methods:{beforeRouteEnter:function(){var t=this;this.mescroll&&(this.lastScrollTop&&(this.mescroll.setScrollTop(this.lastScrollTop),setTimeout((function(){t.mescroll.setTopBtnFadeDuration(0)}),16)),null!=this.lastBounce&&this.mescroll.setBounce(this.lastBounce))},beforeRouteLeave:function(){this.mescroll&&(this.lastScrollTop=this.mescroll.getScrollTop(),this.mescroll.hideTopBtn(0),this.lastBounce=this.mescroll.optUp.isBounce,this.mescroll.setBounce(!0))}}}),r=a,c=o("2877"),p=Object(c["a"])(r,n,s,!1,null,null,null);e["a"]=p.exports},"8fd4":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"box"},[o("van-nav-bar",{attrs:{title:"任务清单","left-text":"首页","left-arrow":""},on:{"click-left":t.onClickLeft},scopedSlots:t._u([{key:"right",fn:function(){return[o("van-icon",{attrs:{name:"filter-o",size:"18"},on:{click:t.isShow}})]},proxy:!0}])}),o("van-search",{attrs:{"show-action":"",shape:"round",placeholder:"模糊搜索：报事人、描述、编号"},scopedSlots:t._u([{key:"action",fn:function(){return[o("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),o("van-popup",{style:{height:"100%"},attrs:{position:"top"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("div",{staticClass:"mescroll-touch"},[o("p",[t._v("事件类型")]),o("div",{staticClass:"minbox flex_w"},t._l(t.baoShiType,(function(e,n){return o("h6",{key:n,class:{discolor:t.changeLeftBackground==n},on:{click:function(o){return t.leftChange(e.id,n)}}},[t._v(t._s(e.eventType))])})),0),o("p",[t._v("报事时间")]),o("div",{staticClass:"time"},[o("van-cell-group",{staticClass:"flex"},[o("van-field",{attrs:{placeholder:"请输入开始时间",readonly:""},on:{click:function(e){t.flag=!0}},model:{value:t.actionTime,callback:function(e){t.actionTime=e},expression:"actionTime"}}),t._v("至\n          "),o("van-field",{attrs:{placeholder:"请输入结束时间",readonly:""},on:{click:function(e){t.flag1=!0}},model:{value:t.xianZaiTime,callback:function(e){t.xianZaiTime=e},expression:"xianZaiTime"}})],1),t.flag?o("van-datetime-picker",{attrs:{type:"date","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.endTime,cancel:t.over},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}}):t._e(),t.flag1?o("van-datetime-picker",{attrs:{type:"date","min-date":t.minDate1,"max-date":t.maxDate1},on:{confirm:t.endTime1,cancel:t.over},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}}):t._e()],1),t.show5?o("p",[t._v("事件逾期")]):t._e(),t.show5?o("div",{staticClass:"minbox flex_w"},t._l(t.baoShiType1,(function(e,n){return o("h6",{key:n,class:{discolor1:t.changeLeftBackground1==n},on:{click:function(o){return t.leftChange1(e.id,n)}}},[t._v(t._s(e.name))])})),0):t._e(),t.show5?o("p",[t._v("完工原因")]):t._e(),t.show5?o("div",{staticClass:"minbox flex_w"},t._l(t.baoShiType2,(function(e,n){return o("h6",{key:n,class:{discolor2:t.changeLeftBackground2==n},on:{click:function(o){return t.leftChange2(e.id,n)}}},[t._v(t._s(e.name))])})),0):t._e(),o("div",{staticClass:"btn flex"},[o("van-button",{attrs:{color:"#999"},on:{click:function(e){t.show=!1}}},[t._v("取消")]),o("van-button",{attrs:{color:"#a48f36"},on:{click:t.filter}},[t._v("确认")])],1)])]),o("div",{staticClass:"con"},[o("van-tabs",{attrs:{color:"#000",background:"#fff",sticky:!0},on:{click:t.dian},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[o("van-tab",{attrs:{title:"未完成"}},[o("Mescroll-vue",{ref:"mescroll",staticClass:"mescroll",attrs:{up:t.mescrollUp,id:"baoGuo"},on:{init:t.mescrollInit}},[0==t.list.length?o("div",{staticClass:"null"},[t._v("暂无记录~")]):t._e(),t._l(t.list,(function(e,n){return o("div",{key:n,staticClass:"minBox",on:{click:function(o){return t.mangeDateils2(e.id,e.reportEventTypeId,e.eventStatusNow)}}},[o("div",{staticClass:"flex col"},[o("span",[t._v("报事类型")]),o("span",[t._v(t._s(e.report_type_name))])]),o("div",{staticClass:"flex col"},[o("span",[t._v("报事人")]),o("span",[t._v(t._s(e.reporter_name))])]),o("div",{staticClass:"flex col"},[o("span",[t._v("报事时间")]),o("span",[t._v(t._s(t._f("teShuTime")(e.createTime)))])]),o("div",{staticClass:"flex col"},[o("span",[t._v("报事描述")]),o("span",{staticClass:"yihang"},[t._v(t._s(e.eventRemark))])]),o("div",{staticClass:"flex col"},[o("span",[t._v("事件编号")]),o("span",{staticClass:"yihang"},[t._v(t._s(e.eventCode))])]),o("van-divider"),9!=e.eventStatusNow&&10!=e.eventStatusNow?o("div",{staticClass:"flex col",staticStyle:{color:"#f00"}},[t._v(t._s(e.tbEventLogBeans[0].fromUserName)+t._s(e.tbEventLogBeans[0].processRemark)+t._s(e.tbEventLogBeans[0].toUserName)+"处理。总耗时"+t._s(t._f("guoQuTime1")(e.createTime,t.dangQianTime)))]):t._e(),9==e.eventStatusNow?o("div",{staticClass:"flex col",staticStyle:{color:"#f00"}},[t._v(t._s(e.tbEventLogBeans[0].fromUserName)+t._s(e.tbEventLogBeans[0].processRemark)+"，"+t._s(e.report_type_name)+"，事件完成。总耗时"+t._s(t._f("guoQuTime")(e.createTime,e.tbEventCompleteBean.createTime)))]):t._e(),10==e.eventStatusNow?o("div",{staticClass:"flex col",staticStyle:{color:"#f00"}},[t._v(t._s(e.tbEventLogBeans[0].fromUserName)+t._s(e.tbEventLogBeans[0].processRemark)+t._s(e.tbEventLogBeans[0].toUserName)+"处理。总耗时"+t._s(t._f("guoQuTime1")(e.createTime,t.dangQianTime)))]):t._e()],1)}))],2)],1),o("van-tab",{attrs:{title:"已完成"}},[t.loading?o("div",{staticStyle:{padding:"180px"}},[o("van-loading",{attrs:{type:"spinner"}})],1):t._e(),o("Mescroll-vue",{ref:"mescroll",staticClass:"mescroll",attrs:{up:t.mescrollUp,id:"baoGuo"},on:{init:t.mescrollInit}},[0==t.list1.length?o("div",{staticClass:"null"},[t._v("暂无记录~")]):t._e(),t._l(t.list1,(function(e,n){return o("div",{key:n,staticClass:"minBox",on:{click:function(o){return t.mangeDateils2(e.id,e.reportEventTypeId,e.eventStatusNow)}}},[o("div",{staticClass:"flex col"},[o("span",[t._v("报事类型")]),o("span",[t._v(t._s(e.report_type_name))])]),o("div",{staticClass:"flex col"},[o("span",[t._v("报事人")]),o("span",[t._v(t._s(e.reporter_name))])]),o("div",{staticClass:"flex col"},[o("span",[t._v("报事时间")]),o("span",[t._v(t._s(t._f("teShuTime")(e.createTime)))])]),o("div",{staticClass:"flex col"},[o("span",[t._v("报事描述")]),o("span",{staticClass:"yihang"},[t._v(t._s(e.eventRemark))])]),o("div",{staticClass:"flex col"},[o("span",[t._v("事件编号")]),o("span",{staticClass:"yihang"},[t._v(t._s(e.eventCode))])]),o("van-divider"),9!=e.eventStatusNow&&10!=e.eventStatusNow?o("div",{staticClass:"flex col",staticStyle:{color:"#00C853"}},[t._v(t._s(e.tbEventLogBeans[0].fromUserName)+t._s(e.tbEventLogBeans[0].processRemark)+"。总耗时"+t._s(t._f("guoQuTime")(e.createTime,e.tbEventLogBeans[0].createTime)))]):t._e(),9==e.eventStatusNow?o("div",{staticClass:"flex col",staticStyle:{color:"#00C853"}},[t._v(t._s(e.tbEventLogBeans[0].fromUserName)+t._s(e.tbEventLogBeans[0].processRemark)+"。总耗时"+t._s(t._f("guoQuTime")(e.createTime,e.tbEventLogBeans[0].createTime)))]):t._e(),10==e.eventStatusNow?o("div",{staticClass:"flex col",staticStyle:{color:"#f00"}},[t._v(t._s(e.tbEventLogBeans[0].fromUserName)+t._s(e.tbEventLogBeans[0].processRemark)+"，事件完成。总耗时"+t._s(t._f("guoQuTime1")(e.createTime,t.dangQianTime)))]):t._e()],1)}))],2)],1)],1)],1),o("div",{staticClass:"break"},[o("van-icon",{attrs:{name:"replay",size:"20",color:"rgb(45,126,249)"},on:{click:t.shua}})],1)],1)},s=[],i=(o("55dd"),o("7f7f"),o("8d6b")),l={components:{MescrollVue:i["a"]},watch:{$route:function(t,e){"home"==e.name&&this.mescroll.resetUpScroll()}},data:function(){return{active:parseInt(localStorage.getItem("action")),show:!1,value:"",xianZaiTime:"",actionTime:"",baoShiType:[],complete:"",baoShiType1:[{name:"全部"},{name:"未逾期"},{name:"已逾期"}],baoShiType2:[{name:"全部"},{name:"自行处理"},{name:"验收合格"},{name:"上报通过"}],page:{num:1,size:10},changeLeftBackground:0,changeLeftBackground1:0,changeLeftBackground2:0,minDate:new Date(2e3,0,1),maxDate:new Date,minDate1:new Date(2e3,0,1),maxDate1:new Date(new Date),currentDate:new Date,flag:!1,flag1:!1,show5:!1,typeId:"",yuQi:"",shiJianType:"1",dangQianTime:new Date,list:[],list1:[],mescroll:null,scroll:"",mescrollUp:{isBounce:!1,callback:this.upCallback,noMoreSize:1,onScroll:function(t,e,o){t.scrollTo(e,0)},toTop:{warpId:null,src:"http://www.mescroll.com/img/mescroll-totop.png",html:null,offset:1e3,warpClass:"mescroll-totop",showClass:"mescroll-fade-in",hideClass:"mescroll-fade-out",duration:300,supportTap:!1,btnClick:null}},loading:!1,scrollTop1:""}},mounted:function(){var t=this;this.time(),this.axios.get("/rest/tbEventTypeConfig/getEventTypes",{params:{uid:localStorage.getItem("uid"),company_id:""}}).then((function(e){console.log(e),e.sort((function(t,e){return t.eventType>e.eventType?1:-1})),t.baoShiType=e;var o={eventType:"全部"};t.baoShiType.unshift(o),t.typeId=""}))},methods:{shua:function(){location.reload()},beforeRouteLeave:function(t,e,o){"taskList"!==t.name&&this.mescroll.setBounce(!0),o()},over:function(){this.flag=!1,this.flag1=!1},onClickLeft:function(){this.mescroll.setBounce(!0),this.$router.push("/")},isShow:function(){this.show=!0},time:function(){var t=new Date;this.xianZaiTime=t.getFullYear()+"-"+this.p(t.getMonth()+1)+"-"+t.getDate()},endTime:function(t){var e=t,o=e.getFullYear()+"-"+this.p(e.getMonth()+1)+"-"+this.p(e.getDate());this.actionTime=o;this.p(e.getHours()),this.p(e.getMinutes()),this.p(e.getSeconds());this.flag=!1},endTime1:function(t){var e=t,o=e.getFullYear()+"-"+this.p(e.getMonth()+1)+"-"+this.p(e.getDate());this.xianZaiTime=o;this.p(e.getHours()),this.p(e.getMinutes()),this.p(e.getSeconds());this.flag1=!1},p:function(t){return t<10?"0"+t:t},leftChange:function(t,e){this.changeLeftBackground=e,this.reportEventTypeId=t,0==e?(console.log("index==0"+this.typeId),this.typeId=""):(console.log("index!=0"+this.typeId),this.typeId=t),console.log(this.typeId)},leftChange1:function(t,e){this.changeLeftBackground1=e,this.reportEventTypeId=t,this.yuQi=0===e?"":1===e?"1":"2",console.log(this.yuQi)},leftChange2:function(t,e){this.changeLeftBackground2=e,this.reportEventTypeId=t,this.complete=0==e?"":1==e?"1":2==e?"2":"3",console.log(this.complete)},mescrollInit:function(t){this.mescroll=t},dian:function(t){console.log(t),0==t?(this.shiJianType="1",this.show5=!1,this.list=[],this.mescroll.resetUpScroll(),this.complete=""):(this.shiJianType="2",this.show5=!0,this.list1=[],this.mescroll.resetUpScroll())},upCallback:function(t,e){var o=this;1==this.shiJianType?this.axios.get("/rest/tbEventReport/getEventsByParam",{params:{page:t.num,limit:t.size,uid:localStorage.getItem("uid"),eventHandleStatus:this.shiJianType,eventStatus:this.yuQi,completedesp:this.complete,eventTypeId:this.typeId,reportTimeStart:this.actionTime+" 00:00:00",reportTimeEnd:this.xianZaiTime+" 23:59:59",searchCon:this.value}}).then((function(n){console.log(n);var s=n.rows;console.log(s),1===t.num&&(o.list=[]),o.list=o.list.concat(s),console.log(o.list),o.$nextTick((function(){e.endSuccess(s.length,!0)})),o.loading=!1})).catch((function(t){e.endErr()})):this.axios.get("/rest/tbEventReport/getEventsByParam",{params:{page:t.num,limit:t.size,uid:localStorage.getItem("uid"),eventHandleStatus:this.shiJianType,eventStatus:this.yuQi,completedesp:this.complete,eventTypeId:this.typeId,reportTimeStart:this.actionTime+" 00:00:00",reportTimeEnd:this.xianZaiTime+" 23:59:59",searchCon:this.value}}).then((function(n){console.log(n);var s=n.rows;console.log(s),1===t.num&&(o.list1=[]),o.list1=o.list1.concat(s),console.log(o.list1),o.$nextTick((function(){e.endSuccess(s.length,!0)})),o.loading=!1})).catch((function(t){e.endErr()}))},mangeDateils2:function(t,e,o){sessionStorage.setItem("id",t),sessionStorage.setItem("eventId",e),sessionStorage.setItem("eventStatusNow",o),this.$router.push("/completeDetails")},onSearch:function(){this.filter()},filter:function(){this.mescroll.resetUpScroll(),this.show=!1,this.loading=!0}}},a=l,r=(o("7ba5"),o("2877")),c=Object(r["a"])(a,n,s,!1,null,"1d02daf6",null);e["default"]=c.exports},c18d:function(t,e,o){},f2fd:function(t,e,o){},f868:function(t,e,o){var n,s;(function(i,l){n=l,s="function"===typeof n?n.call(e,o,e,t):n,void 0===s||(t.exports=s)})(0,(function(){var t=function(t,e){var o=this;if(o.version="1.4.0",o.isScrollBody=!t||"body"===t,o.scrollDom=o.isScrollBody?document.body:o.getDomById(t),o.scrollDom){o.options=e||{};var n=navigator.userAgent,s=!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),i="undefined"===typeof window.orientation,l=n.indexOf("Android")>-1||n.indexOf("Adr")>-1;o.os={ios:s,pc:i,android:l},o.isDownScrolling=!1,o.isUpScrolling=!1;var a=o.options.down&&o.options.down.callback;o.initDownScroll(),o.initUpScroll(),setTimeout((function(){o.optDown.use&&o.optDown.auto&&a&&(o.optDown.autoShowLoading?o.triggerDownScroll():o.optDown.callback&&o.optDown.callback(o)),o.optUp.use&&o.optUp.auto&&!o.isUpAutoLoad&&o.triggerUpScroll()}),30)}};return t.prototype.extendDownScroll=function(e){t.extend(e,{use:!0,auto:!0,autoShowLoading:!1,isLock:!1,isBoth:!1,offset:80,inOffsetRate:1,outOffsetRate:.2,bottomOffset:20,minAngle:45,hardwareClass:"mescroll-hardware",mustToTop:!1,warpId:null,warpClass:"mescroll-downwarp",resetClass:"mescroll-downwarp-reset",textInOffset:"下拉刷新",textOutOffset:"释放更新",textLoading:"加载中 ...",htmlContent:'<p class="downwarp-progress"></p><p class="downwarp-tip"></p>',inited:function(t,e){t.downTipDom=e.getElementsByClassName("downwarp-tip")[0],t.downProgressDom=e.getElementsByClassName("downwarp-progress")[0]},inOffset:function(t){t.downTipDom&&(t.downTipDom.innerHTML=t.optDown.textInOffset),t.downProgressDom&&t.downProgressDom.classList.remove("mescroll-rotate")},outOffset:function(t){t.downTipDom&&(t.downTipDom.innerHTML=t.optDown.textOutOffset)},onMoving:function(t,e,o){if(t.downProgressDom){var n=360*e;t.downProgressDom.style.webkitTransform="rotate("+n+"deg)",t.downProgressDom.style.transform="rotate("+n+"deg)"}},beforeLoading:function(t,e){return!1},showLoading:function(t){t.downTipDom&&(t.downTipDom.innerHTML=t.optDown.textLoading),t.downProgressDom&&t.downProgressDom.classList.add("mescroll-rotate")},afterLoading:function(t){return 0},callback:function(t){t.resetUpScroll()}})},t.prototype.extendUpScroll=function(e){var o=this.os.pc;t.extend(e,{use:!0,auto:!0,isLock:!1,isBoth:!1,isBounce:!0,callback:null,page:{num:0,size:10,time:null},noMoreSize:5,offset:100,toTop:{warpId:null,src:null,html:null,offset:1e3,warpClass:"mescroll-totop",showClass:"mescroll-fade-in",hideClass:"mescroll-fade-out",fadeDuration:.5,duration:300,supportTap:!1,btnClick:null},loadFull:{use:!1,delay:500},empty:{warpId:null,icon:null,tip:"暂无相关数据~",btntext:"",btnClick:null,supportTap:!1},clearId:null,clearEmptyId:null,hardwareClass:"mescroll-hardware",warpId:null,warpClass:"mescroll-upwarp",htmlLoading:'<p class="upwarp-progress mescroll-rotate"></p><p class="upwarp-tip">加载中..</p>',htmlNodata:'<p class="upwarp-nodata">-- END --</p>',inited:function(t,e){},showLoading:function(t,e){e.innerHTML=t.optUp.htmlLoading},showNoMore:function(t,e){e.innerHTML=t.optUp.htmlNodata},onScroll:null,scrollbar:{use:o,barClass:"mescroll-bar"},lazyLoad:{use:!1,attr:"imgurl",showClass:"mescroll-lazy-in",delay:500,offset:200}})},t.extend=function(e,o){if(!e)return o;for(var n in o)null==e[n]?e[n]=o[n]:"object"===typeof e[n]&&t.extend(e[n],o[n]);return e},t.prototype.initDownScroll=function(){var t=this;if(t.optDown=t.options.down||{},t.extendDownScroll(t.optDown),t.touchstartEvent=function(e){t.isScrollTo&&t.preventDefault(e),t.startPoint=t.getPoint(e),t.lastPoint=t.startPoint,t.maxTouchmoveY=t.getBodyHeight()-t.optDown.bottomOffset,t.inTouchend=!1;var o=t.getScrollTop();t.isKeepTop=0===o,t.os.pc&&o<=0&&(t.scrollDom.addEventListener("mousemove",t.touchmoveEvent,{passive:!1}),document.ondragstart=function(){return!1})},t.scrollDom.addEventListener("mousedown",t.touchstartEvent),t.scrollDom.addEventListener("touchstart",t.touchstartEvent),t.touchmoveEvent=function(e){if(t.startPoint){var o=t.getScrollTop();o>0&&(t.isKeepTop=!1);var n=t.getPoint(e),s=n.y-t.startPoint.y;if(s>0){if(o<=0&&(t.preventDefault(e),t.optDown.use&&!t.inTouchend&&!t.isDownScrolling&&!t.optDown.isLock&&(!t.isUpScrolling||t.isUpScrolling&&t.optUp.isBoth))){if(t.optDown.mustToTop&&!t.isKeepTop)return;var i=Math.abs(t.lastPoint.x-n.x),l=Math.abs(t.lastPoint.y-n.y),a=Math.sqrt(i*i+l*l);if(0!==a){var r=Math.asin(l/a)/Math.PI*180;if(r<t.optDown.minAngle)return}if(t.maxTouchmoveY>0&&n.y>=t.maxTouchmoveY)return t.inTouchend=!0,void t.touchendEvent();var c=n.y-t.lastPoint.y;t.downHight||(t.downHight=0),t.downHight<t.optDown.offset?(1!==t.movetype&&(t.movetype=1,t.optDown.inOffset(t),t.downwarp.classList.remove(t.optDown.resetClass),t.isMoveDown=!0,t.os.ios&&!t.isKeepTop&&(t.scrollDom.classList.add(t.optDown.hardwareClass),t.scrollDom.style.webkitOverflowScrolling="auto",t.isSetScrollAuto=!0)),t.downHight+=c*t.optDown.inOffsetRate):(2!==t.movetype&&(t.movetype=2,t.optDown.outOffset(t),t.downwarp.classList.remove(t.optDown.resetClass),t.isMoveDown=!0,t.os.ios&&!t.isKeepTop&&(t.scrollDom.classList.add(t.optDown.hardwareClass),t.scrollDom.style.webkitOverflowScrolling="auto",t.isSetScrollAuto=!0)),t.downHight+=c>0?c*t.optDown.outOffsetRate:c),t.downwarp.style.height=t.downHight+"px";var p=t.downHight/t.optDown.offset;t.optDown.onMoving(t,p,t.downHight)}}else if(s<0){var u=t.getScrollHeight(),h=t.getClientHeight(),d=u-h-o;!t.optUp.isBounce&&d<=0&&t.preventDefault(e),t.optUp.use&&!t.optUp.isLock&&t.optUp.hasNext&&!t.isUpScrolling&&(!t.isDownScrolling||t.isDownScrolling&&t.optDown.isBoth)&&(h+t.optUp.offset>=u||d<=0)&&t.triggerUpScroll()}t.lastPoint=n}},t.scrollDom.addEventListener("touchmove",t.touchmoveEvent,{passive:!1}),t.touchendEvent=function(){t.optDown.use&&t.isMoveDown&&(t.downHight>=t.optDown.offset?t.triggerDownScroll():(t.downwarp.classList.add(t.optDown.resetClass),t.downHight=0,t.downwarp.style.height=0),t.isSetScrollAuto&&(t.scrollDom.style.webkitOverflowScrolling="touch",t.scrollDom.classList.remove(t.optDown.hardwareClass),t.isSetScrollAuto=!1),t.movetype=0,t.isMoveDown=!1),t.os.pc&&(t.scrollDom.removeEventListener("mousemove",t.touchmoveEvent),document.ondragstart=function(){return!0})},t.scrollDom.addEventListener("mouseup",t.touchendEvent),t.scrollDom.addEventListener("mouseleave",t.touchendEvent),t.scrollDom.addEventListener("touchend",t.touchendEvent),t.scrollDom.addEventListener("touchcancel",t.touchendEvent),t.optDown.use){t.downwarp=document.createElement("div"),t.downwarp.className=t.optDown.warpClass,t.downwarp.innerHTML='<div class="downwarp-content">'+t.optDown.htmlContent+"</div>";var e=t.optDown.warpId?t.getDomById(t.optDown.warpId):t.scrollDom;t.optDown.warpId&&e?e.appendChild(t.downwarp):(e||(e=t.scrollDom),e.insertBefore(t.downwarp,t.scrollDom.firstChild)),setTimeout((function(){t.optDown.inited(t,t.downwarp)}),0)}},t.prototype.preventDefault=function(t){t&&t.cancelable&&!t.defaultPrevented&&t.preventDefault()},t.prototype.getPoint=function(t){return{x:t.touches?t.touches[0].pageX:t.clientX,y:t.touches?t.touches[0].pageY:t.clientY}},t.prototype.triggerDownScroll=function(){this.optDown.beforeLoading(this,this.downwarp)||(this.showDownScroll(),this.optDown.callback&&this.optDown.callback(this))},t.prototype.showDownScroll=function(){this.isDownScrolling=!0,this.optDown.showLoading(this),this.downHight=this.optDown.offset,this.downwarp.classList.add(this.optDown.resetClass),this.downwarp.style.height=this.optDown.offset+"px"},t.prototype.endDownScroll=function(){var t=this,e=function(){t.downHight=0,t.downwarp.style.height=0,t.isDownScrolling=!1,t.downProgressDom&&t.downProgressDom.classList.remove("mescroll-rotate")},o=t.optDown.afterLoading(t);"number"===typeof o&&o>0?setTimeout(e,o):e()},t.prototype.lockDownScroll=function(t){null==t&&(t=!0),this.optDown.isLock=t},t.prototype.initUpScroll=function(){var t,e=this;(e.optUp=e.options.up||{use:!1},e.extendUpScroll(e.optUp),e.optUp.scrollbar.use&&e.scrollDom.classList.add(e.optUp.scrollbar.barClass),e.optUp.isBounce||e.setBounce(!1),!1!==e.optUp.use)&&(e.optUp.hasNext=!0,e.upwarp=document.createElement("div"),e.upwarp.className=e.optUp.warpClass,e.optUp.warpId&&(t=e.getDomById(e.optUp.warpId)),t||(t=e.scrollDom),t.appendChild(e.upwarp),e.preScrollY=0,e.lazyStartTime=(new Date).getTime(),e.lazyTag="mescroll-lazying",e.scrollEvent=function(){var t=e.getScrollTop(),o=t-e.preScrollY>0;if(e.preScrollY=t,!e.isUpScrolling&&(!e.isDownScrolling||e.isDownScrolling&&e.optDown.isBoth)&&!e.optUp.isLock&&e.optUp.hasNext){var n=e.getScrollHeight()-e.getClientHeight()-t;n<=e.optUp.offset&&o&&e.triggerUpScroll()}var s=e.optUp.toTop;if((s.src||s.html)&&(t>=s.offset?e.showTopBtn():e.hideTopBtn()),e.optUp.lazyLoad.use){var i=(new Date).getTime();e.lazyTimer&&clearTimeout(e.lazyTimer),i-e.lazyStartTime>=e.optUp.lazyLoad.delay?(e.lazyStartTime=i,e.lazyLoad(0)):e.lazyTimer=e.lazyLoad()}e.optUp.onScroll&&e.optUp.onScroll(e,t,o)},e.isScrollBody?window.addEventListener("scroll",e.scrollEvent):e.scrollDom.addEventListener("scroll",e.scrollEvent),setTimeout((function(){e.optUp.inited(e,e.upwarp)}),0))},t.prototype.setBounce=function(t){!this.isScrollBody&&this.os.ios&&(!1===t?(this.optUp.isBounce=!1,window.addEventListener("touchmove",this.bounceTouchmove,{passive:!1})):(this.optUp.isBounce=!0,window.removeEventListener("touchmove",this.bounceTouchmove)))},t.prototype.bounceTouchmove=function(t){var e=this,o=t.target,n=!0;while(o!==document.body&&o!==document){var s=o.classList;if(s){if(s.contains("mescroll")||s.contains("mescroll-touch")){n=!1;break}if(s.contains("mescroll-touch-x")||s.contains("mescroll-touch-y")){var i=t.touches?t.touches[0].pageX:t.clientX,l=t.touches?t.touches[0].pageY:t.clientY;e.preWinX||(e.preWinX=i),e.preWinY||(e.preWinY=l);var a=Math.abs(e.preWinX-i),r=Math.abs(e.preWinY-l),c=Math.sqrt(a*a+r*r);if(e.preWinX=i,e.preWinY=l,0!==c){var p=Math.asin(r/c)/Math.PI*180;if(p<=45&&s.contains("mescroll-touch-x")||p>45&&s.contains("mescroll-touch-y")){n=!1;break}}}}o=o.parentNode}n&&t.cancelable&&!t.defaultPrevented&&"function"===typeof t.preventDefault&&t.preventDefault()},t.prototype.triggerUpScroll=function(){this.optUp.callback&&!this.isUpScrolling&&(this.showUpScroll(),this.optUp.page.num++,this.isUpAutoLoad=!0,this.optUp.callback(this.optUp.page,this))},t.prototype.showUpScroll=function(){this.isUpScrolling=!0,this.upwarp.classList.add(this.optUp.hardwareClass),this.upwarp.style.visibility="visible",this.upwarp.style.display="block",this.optUp.showLoading(this,this.upwarp)},t.prototype.showNoMore=function(){this.upwarp.style.visibility="visible",this.upwarp.style.display="block",this.optUp.hasNext=!1,this.optUp.showNoMore(this,this.upwarp)},t.prototype.hideUpScroll=function(t){t?this.upwarp.style.display="none":this.upwarp.style.visibility="hidden",this.upwarp.classList.remove(this.optUp.hardwareClass);var e=this.upwarp.getElementsByClassName("upwarp-progress")[0];e&&e.classList.remove("mescroll-rotate")},t.prototype.endUpScroll=function(t,e){null!=t&&(t?this.showNoMore():this.hideUpScroll(e)),this.isUpScrolling=!1},t.prototype.resetUpScroll=function(t){if(this.optUp&&this.optUp.use){var e=this.optUp.page;this.prePageNum=e.num,this.prePageTime=e.time,e.num=1,e.time=null,this.isDownScrolling||!1===t||(null==t?(this.removeEmpty(),this.clearDataList(),this.showUpScroll()):this.showDownScroll()),this.isUpAutoLoad=!0,this.optUp.callback&&this.optUp.callback(e,this)}},t.prototype.setPageNum=function(t){this.optUp.page.num=t-1},t.prototype.setPageSize=function(t){this.optUp.page.size=t},t.prototype.clearDataList=function(){var t=this.optUp.clearId||this.optUp.clearEmptyId;if(t){var e=this.getDomById(t);e&&(e.innerHTML="")}},t.prototype.endByPage=function(t,e,o){var n;this.optUp.use&&null!=e&&(n=this.optUp.page.num<e),this.endSuccess(t,n,o)},t.prototype.endBySize=function(t,e,o){var n;if(this.optUp.use&&null!=e){var s=(this.optUp.page.num-1)*this.optUp.page.size+t;n=s<e}this.endSuccess(t,n,o)},t.prototype.endSuccess=function(t,e,o){var n=this;if(n.isDownScrolling&&n.endDownScroll(),n.optUp.use){var s;if(null!=t){var i=n.optUp.page.num,l=n.optUp.page.size;if(1===i&&(n.clearDataList(),o&&(n.optUp.page.time=o)),t<l||!1===e)if(n.optUp.hasNext=!1,0===t&&1===i)s=!1,n.showEmpty();else{var a=(i-1)*l+t;s=!(a<n.optUp.noMoreSize),n.removeEmpty()}else s=!1,n.optUp.hasNext=!0,n.removeEmpty()}var r=!n.optUp.hasNext;n.endUpScroll(s,r),n.loadFull(),n.optUp.lazyLoad.use&&n.lazyLoad(16)}},t.prototype.endErr=function(){if(this.isDownScrolling){var t=this.optUp.page;t&&this.prePageNum&&(t.num=this.prePageNum,t.time=this.prePageTime),this.endDownScroll()}this.isUpScrolling&&(this.optUp.page.num--,this.endUpScroll(!1))},t.prototype.loadFull=function(){var t=this;t.optUp.loadFull.use&&!t.optUp.isLock&&t.optUp.hasNext&&t.optUp.callback&&t.getScrollHeight()<=t.getClientHeight()&&setTimeout((function(){t.getScrollHeight()<=t.getClientHeight()&&t.triggerUpScroll()}),t.optUp.loadFull.delay)},t.prototype.lockUpScroll=function(t){null==t&&(t=!0),this.optUp.isLock=t},t.prototype.showEmpty=function(){var t=this,e=t.optUp.empty,o=e.warpId||t.optUp.clearEmptyId;if(null!=o){var n=t.getDomById(o);if(n){t.removeEmpty();var s="";if(e.icon&&(s+='<img class="empty-icon" src="'+e.icon+'"/>'),e.tip&&(s+='<p class="empty-tip">'+e.tip+"</p>"),e.btntext&&(s+='<p class="empty-btn">'+e.btntext+"</p>"),t.emptyDom=document.createElement("div"),t.emptyDom.className="mescroll-empty",t.emptyDom.innerHTML=s,n.appendChild(t.emptyDom),e.btnClick){var i=t.emptyDom.getElementsByClassName("empty-btn")[0];e.supportTap?i.addEventListener("tap",(function(o){o.stopPropagation(),t.preventDefault(o),e.btnClick()})):i.onclick=function(){e.btnClick()}}}}},t.prototype.removeEmpty=function(){this.removeChild(this.emptyDom)},t.prototype.showTopBtn=function(t){if(!this.topBtnShow){this.topBtnShow=!0;var e,o=this,n=o.optUp.toTop;if(null==o.toTopBtn)n.html?(o.toTopBtn=document.createElement("div"),o.toTopBtn.innerHTML=n.html):(o.toTopBtn=document.createElement("img"),o.toTopBtn.src=n.src),o.toTopBtn.className=n.warpClass,n.supportTap?o.toTopBtn.addEventListener("tap",(function(t){t.stopPropagation(),o.preventDefault(t);var e=n.btnClick&&n.btnClick();!0!==e&&o.scrollTo(0,o.optUp.toTop.duration)})):o.toTopBtn.onclick=function(){var t=n.btnClick&&n.btnClick();!0!==t&&o.scrollTo(0,o.optUp.toTop.duration)},n.warpId&&(e=o.getDomById(n.warpId)),e||(e=document.body),e.appendChild(o.toTopBtn);o.toTopBtn.classList.remove(n.hideClass),o.toTopBtn.classList.add(n.showClass),o.setTopBtnFadeDuration(t)}},t.prototype.hideTopBtn=function(t){this.topBtnShow&&this.toTopBtn&&(this.topBtnShow=!1,this.toTopBtn.classList.remove(this.optUp.toTop.showClass),this.toTopBtn.classList.add(this.optUp.toTop.hideClass),this.setTopBtnFadeDuration(t))},t.prototype.setTopBtnFadeDuration=function(t){if(this.toTopBtn){var e=(null!=t?t:this.optUp.toTop.fadeDuration)+"s";this.toTopBtn.style.animationDuration=e,this.toTopBtn.style.webkitAnimationDuration=e}},t.prototype.scrollTo=function(t,e){var o=this,n=o.getScrollTop(),s=t;if(s>0){var i=o.getScrollHeight()-o.getClientHeight();s>i&&(s=i)}else s=0;o.isScrollTo=!0,o.scrollDom.style.webkitOverflowScrolling="auto",o.getStep(n,s,(function(t){o.setScrollTop(t),t===s&&(o.scrollDom.style.webkitOverflowScrolling="touch",o.isScrollTo=!1)}),e)},t.prototype.getStep=function(t,e,o,n,s){var i=e-t;if(0!==n&&0!==i){n=n||300,s=s||30;var l=n/s,a=i/l,r=0,c=window.setInterval((function(){r<l-1?(t+=a,o&&o(t,c),r++):(o&&o(e,c),window.clearInterval(c))}),s)}else o&&o(e)},t.prototype.lazyLoad=function(t){var e=this,o=null!=t?t:e.optUp.lazyLoad.delay,n=setTimeout((function(){for(var t=e.scrollDom.querySelectorAll("["+e.optUp.lazyLoad.attr+"]"),o=t.length,n=0;n<o;n++){var s=t[n];if("true"!==s.getAttribute(e.lazyTag)&&e.isInSee(s,e.optUp.lazyLoad.offset)){var i=s.getAttribute(e.optUp.lazyLoad.attr),l=new Image;l.onload=function(){var t=this.src,o=this.dom,n=e.optUp.lazyLoad.showClass;n&&o.classList.add(n),"IMG"===o.tagName?o.src=t:o.style.backgroundImage="url("+t+")",o.removeAttribute(e.optUp.lazyLoad.attr),o.removeAttribute(e.lazyTag)},l.onerror=function(){this.dom.removeAttribute(e.lazyTag)},l.onabort=function(){this.dom.removeAttribute(e.lazyTag)},l.src=i,s.setAttribute(e.lazyTag,"true"),l.dom=s}}}),o);return n},t.prototype.isInSee=function(t,e){e=e||0;var o=this.getOffsetTop(t),n=this.getScrollTop()-e,s=o+t.offsetHeight,i=n+e+this.getClientHeight()+e;return o<i&&o>=n||s<=i&&s>n},t.prototype.getOffsetTop=function(t){var e=t.offsetTop,o=t.offsetParent;while(null!=o&&o!==this.scrollDom)e+=o.offsetTop+o.clientTop,o=o.offsetParent;return e},t.prototype.getScrollHeight=function(){return this.scrollDom.scrollHeight},t.prototype.getClientHeight=function(){return this.isScrollBody&&"CSS1Compat"===document.compatMode?document.documentElement.clientHeight:this.scrollDom.clientHeight},t.prototype.getBodyHeight=function(){return document.body.clientHeight||document.documentElement.clientHeight},t.prototype.getScrollTop=function(){return this.isScrollBody?document.documentElement.scrollTop||document.body.scrollTop:this.scrollDom.scrollTop},t.prototype.getToBottom=function(){return this.getScrollHeight()-this.getClientHeight()-this.getScrollTop()},t.prototype.setScrollTop=function(t){"number"===typeof t&&(this.isScrollBody?(document.documentElement.scrollTop=t,document.body.scrollTop=t):this.scrollDom.scrollTop=t)},t.prototype.getDomById=function(t){var e;return t&&("string"===typeof t?e=document.getElementById(t):t.nodeType&&(e=t)),e||console.error('the element with id as "'+t+'" can not be found: document.getElementById("'+t+'")==null'),e},t.prototype.removeChild=function(t){if(t){var e=t.parentNode;e&&e.removeChild(t),t=null}},t.prototype.destroy=function(){var t=this;t.scrollDom.removeEventListener("touchstart",t.touchstartEvent),t.scrollDom.removeEventListener("touchmove",t.touchmoveEvent),t.scrollDom.removeEventListener("touchend",t.touchendEvent),t.scrollDom.removeEventListener("touchcancel",t.touchendEvent),t.scrollDom.removeEventListener("mousedown",t.touchstartEvent),t.scrollDom.removeEventListener("mousemove",t.touchmoveEvent),t.scrollDom.removeEventListener("mouseup",t.touchendEvent),t.scrollDom.removeEventListener("mouseleave",t.touchendEvent),t.removeChild(t.downwarp),t.isScrollBody?window.removeEventListener("scroll",t.scrollEvent):t.scrollDom.removeEventListener("scroll",t.scrollEvent),t.removeChild(t.upwarp),t.removeChild(t.toTopBtn),t.setBounce(!0)},t}))}}]);