(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65ca65f8"],{"7e01":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"equipment-info-container"},[n("van-nav-bar",{staticStyle:{position:"fixed",width:"100%"},attrs:{title:"设备信息","left-arrow":""},on:{"click-left":e.onBack}}),n("div",{staticClass:"content"},[n("van-cell-group",[n("van-cell",{attrs:{title:"位置",value:e.oEquipmentInfo.buildingName}}),n("van-cell",{attrs:{title:"设备类型",value:e.oEquipmentInfo.typeName}}),n("van-cell",{attrs:{title:"设备名称",value:e.oEquipmentInfo.name}}),n("van-cell",{attrs:{title:"设备状态"},scopedSlots:e._u([{key:"right-icon",fn:function(){return[n("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.oEquipmentInfo.checkStatus,callback:function(t){e.$set(e.oEquipmentInfo,"checkStatus",t)},expression:"oEquipmentInfo.checkStatus"}},[n("van-radio",{attrs:{name:"2","icon-size":"12px"}},[e._v("异常")]),n("van-radio",{attrs:{name:"1","icon-size":"12px"}},[e._v("正常")])],1)]},proxy:!0}])}),n("div",{staticClass:"p-event-label"},[e._v("备注")]),n("van-field",{attrs:{rows:"1",autosize:{minHeight:150},type:"textarea",placeholder:"填入备注信息",maxlength:"200","show-word-limit":""},model:{value:e.oEquipmentInfo.remark,callback:function(t){e.$set(e.oEquipmentInfo,"remark",t)},expression:"oEquipmentInfo.remark"}}),n("van-uploader",{attrs:{"after-read":e.afterRead,"before-delete":e.fnDeleteHandler,"max-count":3},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1),n("div",{staticClass:"btn-group"},[n("van-button",{attrs:{type:"default",color:"#A68E44"},on:{click:e.onConfirm}},[e._v("确定")])],1)],1)],1)},a=[],o=(n("96cf"),n("3b8d")),r=(n("7f7f"),n("34ef"),n("4917"),n("28a5"),n("9788")),c=n("bc3a"),u=n.n(c),s={components:{},data:function(){return{radio:"",remark:"",oEquipmentInfo:{id:this.$route.query.detailId,buildingName:"",typeName:"",name:"",checkStatus:"",remark:"",checkImgUrl:"https://img.yzcdn.cn/vant/leaf.jpg"},fileList:[],aFileUrl:[]}},created:function(){this.apiGetEquipmentDetail(this.$route.query.detailId)},mounted:function(){},methods:{onBack:function(){this.$router.go(-1)},afterRead:function(e){this.updateImg(e)},fnDeleteHandler:function(e,t){return this.aFileUrl.splice(t.index,1),!0},onConfirm:function(){this.oEquipmentInfo.checkStatus?this.fileList.length<=0?this.$toast("未拍摄照片！"):this.apiSaveEquipmentInfo():this.$toast("未选择设备状态！")},dataURLtoFile:function(e,t){var n=e.split(","),i=n[0].match(/:(.*?);/)[1],a=atob(n[1]),o=a.length,r=new Uint8Array(o);while(o--)r[o]=a.charCodeAt(o);return new File([r],t,{type:i})},updateImg:function(e){var t=this,n=document.createElement("canvas"),i=n.getContext("2d"),a=new Image;a.src=e.content,a.onload=function(){n.width=400,n.height=300,i.drawImage(a,0,0,400,300),e.content=n.toDataURL(e.file.type,.92);var o=t.dataURLtoFile(e.content,e.file.name);t.apiUploadFile(o)}},apiSaveEquipmentInfo:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.oEquipmentInfo.checkImgUrl=this.aFileUrl.join(","),e.next=3,Object(r["n"])(this.oEquipmentInfo);case 3:e.sent,this.$router.go(-1);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),apiUploadFile:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=new FormData,n.append("file",t),u.a.post(this.$baseConfig.BASE_URL+"/public/rest/img/upload",n).then((function(e){i.aFileUrl.push(i.$baseConfig.BASE_URL+"/public/rest/img/"+e.data.result)}));case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),apiGetEquipmentDetail:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(r["d"])({detailId:t});case 2:n=e.sent,n&&(this.oEquipmentInfo.buildingName=n.dinfo.buildingName,this.oEquipmentInfo.name=n.dinfo.name,this.oEquipmentInfo.typeName=n.dinfo.typeName),console.log("getEquipmentDetailApi:",n);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},computed:{}},l=s,p=(n("e42e"),n("2877")),f=Object(p["a"])(l,i,a,!1,null,"64ea57d4",null);t["default"]=f.exports},e42e:function(e,t,n){"use strict";var i=n("e474"),a=n.n(i);a.a},e474:function(e,t,n){}}]);